<!DOCTYPE html>
<html>
    <head>
        <title>Instinctual experiment</title>
        <style>
            @keyframes dancingcreature {
                from { transform: rotate(7deg); }
                to { transform: rotate(-7deg); }
            }

            .creature-dancing {
                animation: dancingcreature 0.5s;
                animation-iteration-count: infinite;
                animation-direction: alternate;
            }

            @keyframes spawningcreature {
                from {
                    height: 5px;
                    width: 5px;

                    margin: 25px;
                }
                to {
                    height: 50px;
                    width: 50px;

                    margin: 0px;
                }
            }

            .creature-spawning {
                animation: spawningcreature 0.5s;
                animation-iteration-count: 1;
            }

            @keyframes dyingcreature {
                from { }
                to {
                    background-color: #DB5168;

                    height: 5px;
                    width: 5px;

                    margin: 25px;
                }
            }

            .creature-dying {
                animation: dyingcreature 0.5s;
                animation-iteration-count: 1;
            }

            .canvas {
                margin: 0 auto;

                width: 600px;
                height: 600px;

                background-color: #09EA76; 

                position: relative;

                border-radius: 10px;
            }

            .creature {
                position: absolute;

                height: 50px;
                width: 50px;

                display: block;

                border-radius: 15px;
            }
        </style>
        <script src="http://code.jquery.com/jquery-2.1.1.js"></script>
        <script>
            var Instinct = {};

            Instinct.drawCreatures = function (creatures) {
                $('.creature').data('dead', true);

                creatures.forEach(function(creature) {
                    this.drawCreature(creature);
                }, this);

                $('.creature')
                    .filter(function () {
                        return $(this).data('dead');
                    })
                    .removeClass('creature-dancing')
                    .addClass('creature-dying');

                setTimeout(function () {
                    $('.creature-dying').remove();
                }, 501);
            };

            Instinct.drawCreature = function (creature) {
                if ($('#creature' + creature.id).length) {
                    $('#creature' + creature.id).data('dead', false);

                    return;
                }

                var creatureDom = $('<div>')
                    .addClass('creature creature-dancing creature-spawning')
                    .attr('id', 'creature' + creature.id)
                    .css('left', (creature.x * 50) + "px")
                    .css('top', (creature.y * 50) + "px")
                    .css('background-color', "rgb(" + creature.color.r + "," + creature.color.g + "," + creature.color.b + ")")
                    .data('dead', false);

                $('.canvas').append(creatureDom);
                setTimeout(function () {
                    creatureDom.removeClass('creature-spawning');
                }, 501);
            };

            setInterval(function () {
                $.ajax({
                    url: 'creature-positions.php',
                    success: Instinct.drawCreatures,
                    dataType: 'json',
                    context: Instinct
                });
            }, 5000);
        </script>
    </head>
    <body>
        <div class="canvas">

        </div>
    </body>
</html>
